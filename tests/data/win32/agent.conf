  <agent_config>
    <!-- Default configuration for all systems -->
    <logging>
      <log_format>plain,json</log_format>
    </logging>
    <global>
      <jsonout_output>yes</jsonout_output>
      <alerts_log>yes</alerts_log>
      <logall>no</logall>
      <logall_json>no</logall_json>
      <email_maxperhour>12</email_maxperhour>
      <agents_disconnection_time>10m</agents_disconnection_time>
      <agents_disconnection_alert_time>0</agents_disconnection_alert_time>
    </global>
    <!-- Force reconnect agent-manager connection every 30 mins, even when there is a successful connection.
    It is needed when there is a long-term network connectivity or server issue. -->
    <client>
      <force_reconnect_interval>30m</force_reconnect_interval>
    </client>
    <!-- Disable Security Configuration Assessment -->
    <sca>
      <enabled>no</enabled>
    </sca>
  </agent_config>
  <agent_config os="^Linux">
    <!-- Linux catch-all log file location -->
    <localfile>
      <location>/var/log/wazuh.log</location>
      <log_format>syslog</log_format>
    </localfile>
    <!-- HAproxy logs -->
    <localfile>
      <log_format>syslog</log_format>
      <location>/var/log/haproxy-*.log</location>
    </localfile>
    <!-- File integrity monitoring -->
    <syscheck>
      <disabled>no</disabled>
      <!-- Frequency that syscheck is executed default every 6 hours -->
      <frequency>21600</frequency>
      <scan_on_start>yes</scan_on_start>
      <!-- Directories to check  in Linux (perform all possible verifications) -->
      <directories check_all="yes" report_changes="yes" realtime="yes" whodata="yes">/root</directories>
      <directories check_all="yes" report_changes="yes" realtime="yes" whodata="yes">/etc,/usr/bin,/usr/sbin</directories>
      <directories check_all="yes" report_changes="yes" realtime="yes" whodata="yes">/bin,/sbin,/boot</directories>
      <directories check_all="yes" report_changes="yes" realtime="yes" whodata="yes">/var/ossec/etc</directories>
      <directories check_all="yes" report_changes="yes" realtime="yes" whodata="yes">/opt</directories>
      <directories check_all="yes" report_changes="yes" realtime="yes" whodata="yes">/home/*/.config/powershell</directories>
      <!-- Files/directories to ignore -->
      <ignore>/etc/mtab</ignore>
      <ignore>/etc/hosts.deny</ignore>
      <ignore>/etc/mail/statistics</ignore>
      <ignore>/etc/random-seed</ignore>
      <ignore>/etc/random.seed</ignore>
      <ignore>/etc/adjtime</ignore>
      <ignore>/etc/httpd/logs</ignore>
      <ignore>/etc/utmpx</ignore>
      <ignore>/etc/wtmpx</ignore>
      <ignore>/etc/cups/certs</ignore>
      <ignore>/etc/dumpdates</ignore>
      <ignore>/etc/svc/volatile</ignore>
      <!-- Nessus database update create noise -->
      <ignore>/opt/nessus</ignore>
      <!-- Gitlab stats update creates noise -->
      <ignore>/opt/gitlab/sv/logrotate/supervise</ignore>
      <!-- Grafana Loki creates noise -->
      <ignore>/opt/loki</ignore>
      <!-- Banknet error logs creates noise-->
      <ignore>/opt/appadm/banknet/log/</ignore>
      <!-- Visa error logs creates noise-->
      <ignore>/opt/appadm/visa/log/</ignore>
      <!-- Prometheus WAL (write ahead log) creates noise-->
      <ignore>/opt/prometheus/data/wal/</ignore>
      <!-- File types to ignore -->
      <ignore type="sregex">.log$|.swp$</ignore>
      <!-- Qualys agent configuration -->
      <ignore type="sregex">^/etc/qualys/cloud-agent/qagent-edr.conf</ignore>
      <!-- Check Point EDR Sandbox -->
      <ignore type="sregex">^/var/lib/checkpoint/cpla-sandbox</ignore>
      <!-- Kubernetes Managed Folders-->
      <ignore type="sregex">^/var/lib/kubelet/pods/</ignore>
      <ignore type="sregex">^/var/lib/docker/volumes/</ignore>
      <ignore type="sregex">^/var/lib/docker/overlay2/</ignore>
      <ignore type="sregex">^var/lib/rancher/rke2/agent/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/</ignore>
      <!-- Kubernetes termination logs -->
      <ignore type="sregex">^/dev/termination-log</ignore>
      <!--  Oracle ASM Filter Driver managed disks -->
      <ignore type="sregex">^/dev/oracleafd/disks/</ignore>
      <!-- Check Point EDR uses honeypot files or decoys for detection. However, the pattern for this is a bit complex. -->
      <ignore type="sregex">.CheckPoint</ignore>
      <ignore type="sregex">.Check Point</ignore>
      <ignore type="sregex">.Check-Point</ignore>
      <ignore type="sregex">.Endpoint</ignore>
      <ignore type="sregex">.Sandblast</ignore>
      <ignore type="sregex">.Sandblast Agent</ignore>
      <ignore type="sregex">.Sandblast Zero-Day</ignore>
      <ignore type="sregex">.CP</ignore>
      <ignore type="sregex">.$CheckPoint</ignore>
      <ignore type="sregex">.$Check Point</ignore>
      <ignore type="sregex">.$Check-Point</ignore>
      <ignore type="sregex">.$Endpoint</ignore>
      <ignore type="sregex">.$Sandblast</ignore>
      <ignore type="sregex">.$Sandblast Agent</ignore>
      <ignore type="sregex">.$Sandblast Zero-Day</ignore>
      <ignore type="sregex">.$CP</ignore>
      <ignore type="sregex">.@CheckPoint</ignore>
      <ignore type="sregex">.@Check Point</ignore>
      <ignore type="sregex">.@Check-Point</ignore>
      <ignore type="sregex">.@Endpoint</ignore>
      <ignore type="sregex">.@Sandblast</ignore>
      <ignore type="sregex">.@Sandblast Agent</ignore>
      <ignore type="sregex">.@Sandblast Zero-Day</ignore>
      <ignore type="sregex">.@CP</ignore>
      <ignore type="sregex">._CheckPoint</ignore>
      <ignore type="sregex">._Check Point</ignore>
      <ignore type="sregex">._Check-Point</ignore>
      <ignore type="sregex">._Endpoint</ignore>
      <ignore type="sregex">._Sandblast</ignore>
      <ignore type="sregex">._Sandblast Agent</ignore>
      <ignore type="sregex">._Sandblast Zero-Day</ignore>
      <ignore type="sregex">._CP</ignore>
      <ignore type="sregex">. CheckPoint</ignore>
      <ignore type="sregex">. Check Point</ignore>
      <ignore type="sregex">. Check-Point</ignore>
      <ignore type="sregex">. Endpoint</ignore>
      <ignore type="sregex">. Sandblast</ignore>
      <ignore type="sregex">. Sandblast Agent</ignore>
      <ignore type="sregex">. Sandblast Zero-Day</ignore>
      <ignore type="sregex">. CP</ignore>
      <ignore type="sregex">..CheckPoint</ignore>
      <ignore type="sregex">..Check Point</ignore>
      <ignore type="sregex">..Check-Point</ignore>
      <ignore type="sregex">..Endpoint</ignore>
      <ignore type="sregex">..Sandblast</ignore>
      <ignore type="sregex">..Sandblast Agent</ignore>
      <ignore type="sregex">..Sandblast Zero-Day</ignore>
      <ignore type="sregex">..CP</ignore>
      <ignore type="sregex">.!CheckPoint</ignore>
      <ignore type="sregex">.!Check Point</ignore>
      <ignore type="sregex">.!Check-Point</ignore>
      <ignore type="sregex">.!Endpoint</ignore>
      <ignore type="sregex">.!Sandblast</ignore>
      <ignore type="sregex">.!Sandblast Agent</ignore>
      <ignore type="sregex">.!Sandblast Zero-Day</ignore>
      <ignore type="sregex">.!CP</ignore>
      <ignore type="sregex">.0CheckPoint</ignore>
      <ignore type="sregex">.0Check Point</ignore>
      <ignore type="sregex">.0Check-Point</ignore>
      <ignore type="sregex">.0Endpoint</ignore>
      <ignore type="sregex">.0Sandblast</ignore>
      <ignore type="sregex">.0Sandblast Agent</ignore>
      <ignore type="sregex">.0Sandblast Zero-Day</ignore>
      <ignore type="sregex">.0CP</ignore>
      <ignore type="sregex">CheckPoint</ignore>
      <ignore type="sregex">Check Point</ignore>
      <ignore type="sregex">Check-Point</ignore>
      <ignore type="sregex">Endpoint</ignore>
      <ignore type="sregex">Sandblast</ignore>
      <ignore type="sregex">Sandblast Agent</ignore>
      <ignore type="sregex">Sandblast Zero-Day</ignore>
      <ignore type="sregex">CP</ignore>
      <!-- Ignore IBM storage witness quorum logs -->
      <ignore>/opt/IBM/ip-quorum/log/</ignore>
      <!-- Check the file, but never compute the diff -->
      <nodiff>/etc/ssl/private.key</nodiff>
      <skip_nfs>yes</skip_nfs>
      <skip_dev>yes</skip_dev>
      <skip_proc>yes</skip_proc>
      <skip_sys>yes</skip_sys>
      <!-- Nice value for Syscheck process -->
      <process_priority>10</process_priority>
      <!-- Maximum output throughput -->
      <max_eps>100</max_eps>
      <!-- Database synchronization settings -->
      <synchronization>
        <enabled>yes</enabled>
        <interval>5m</interval>
        <max_interval>1h</max_interval>
        <max_eps>20</max_eps>
      </synchronization>
    </syscheck>
    <rootcheck>
      <!-- Ignore rootcheck false positives for "Trojaned version of file detected."
      Ref: https://github.com/wazuh/wazuh/issues/19346 -->
      <ignore type="sregex">^/bin/mail</ignore>
      <ignore type="sregex">^/usr/bin/mail</ignore>
      <ignore type="sregex">^/sbin/sendmail</ignore>
      <ignore type="sregex">^/usr/sbin/sendmail</ignore>
      <ignore type="sregex">^/usr/bin/diff</ignore>
      <ignore type="sregex">^/bin/diff</ignore>
      <!-- Qualys agent configuration -->
      <ignore type="sregex">^/etc/qualys/cloud-agent/qagent-edr.conf</ignore>
      <!-- Check Point EDR Sandbox -->
      <ignore type="sregex">^/var/lib/checkpoint/cpla-sandbox</ignore>
      <!-- Kubernetes Managed Folders-->
      <ignore type="sregex">^/var/lib/kubelet/pods/</ignore>
      <ignore type="sregex">^/var/lib/docker/volumes/</ignore>
      <ignore type="sregex">^/var/lib/docker/overlay2/</ignore>
      <ignore type="sregex">^var/lib/rancher/rke2/agent/containerd/io.containerd.snapshotter.v1.overlayfs/snapshots/</ignore>
      <!-- Kubernetes termination logs -->
      <ignore type="sregex">^/dev/termination-log</ignore>
      <!--  Oracle ASM Filter Driver managed disks -->
      <ignore type="sregex">^/dev/oracleafd/disks/</ignore>
      <!-- Check Point EDR uses honeypot files or decoys for detection. However, the pattern for this is a bit complex:
      (?i)\.(?:[\$@_\s\.!0]?)(?:Check([\s\-]?)Point|Endpoint|Sandblast|Sandblast Agent|Sandblast Zero\-Day|CP)(?:Safeguarded|Monitored|Guarded|Defended|Secured|Protected)(?:File|Repo|Repository|Information|Record|Asset|Content|Data|Document|Resource)(?:Avoid|Don't|Do Not)(?:Remove|Wipe|Discard|Delete|Erase)
      - First Segment: 7 options (punctuation marks, space and none) Ã— 8 options (word combinations) = 64 options.
      - Second Segment: 6 options.
      - Third Segment: 10 options.
      - Fourth Segment: 3 options.
      - Fifth Segment: 5 options.
      Total Combinations = 64 * 6 * 10 * 3 * 5 = 57,600 possible combinations.
      Since rootcheck ony uses simple regex, or sregex, the pattern above won't work. So, it is easier to just use the first segment to ignore. We can use 64 lines instad of 57,600. -->
      <ignore type="sregex">.CheckPoint</ignore>
      <ignore type="sregex">.Check Point</ignore>
      <ignore type="sregex">.Check-Point</ignore>
      <ignore type="sregex">.Endpoint</ignore>
      <ignore type="sregex">.Sandblast</ignore>
      <ignore type="sregex">.Sandblast Agent</ignore>
      <ignore type="sregex">.Sandblast Zero-Day</ignore>
      <ignore type="sregex">.CP</ignore>
      <ignore type="sregex">.$CheckPoint</ignore>
      <ignore type="sregex">.$Check Point</ignore>
      <ignore type="sregex">.$Check-Point</ignore>
      <ignore type="sregex">.$Endpoint</ignore>
      <ignore type="sregex">.$Sandblast</ignore>
      <ignore type="sregex">.$Sandblast Agent</ignore>
      <ignore type="sregex">.$Sandblast Zero-Day</ignore>
      <ignore type="sregex">.$CP</ignore>
      <ignore type="sregex">.@CheckPoint</ignore>
      <ignore type="sregex">.@Check Point</ignore>
      <ignore type="sregex">.@Check-Point</ignore>
      <ignore type="sregex">.@Endpoint</ignore>
      <ignore type="sregex">.@Sandblast</ignore>
      <ignore type="sregex">.@Sandblast Agent</ignore>
      <ignore type="sregex">.@Sandblast Zero-Day</ignore>
      <ignore type="sregex">.@CP</ignore>
      <ignore type="sregex">._CheckPoint</ignore>
      <ignore type="sregex">._Check Point</ignore>
      <ignore type="sregex">._Check-Point</ignore>
      <ignore type="sregex">._Endpoint</ignore>
      <ignore type="sregex">._Sandblast</ignore>
      <ignore type="sregex">._Sandblast Agent</ignore>
      <ignore type="sregex">._Sandblast Zero-Day</ignore>
      <ignore type="sregex">._CP</ignore>
      <ignore type="sregex">. CheckPoint</ignore>
      <ignore type="sregex">. Check Point</ignore>
      <ignore type="sregex">. Check-Point</ignore>
      <ignore type="sregex">. Endpoint</ignore>
      <ignore type="sregex">. Sandblast</ignore>
      <ignore type="sregex">. Sandblast Agent</ignore>
      <ignore type="sregex">. Sandblast Zero-Day</ignore>
      <ignore type="sregex">. CP</ignore>
      <ignore type="sregex">..CheckPoint</ignore>
      <ignore type="sregex">..Check Point</ignore>
      <ignore type="sregex">..Check-Point</ignore>
      <ignore type="sregex">..Endpoint</ignore>
      <ignore type="sregex">..Sandblast</ignore>
      <ignore type="sregex">..Sandblast Agent</ignore>
      <ignore type="sregex">..Sandblast Zero-Day</ignore>
      <ignore type="sregex">..CP</ignore>
      <ignore type="sregex">.!CheckPoint</ignore>
      <ignore type="sregex">.!Check Point</ignore>
      <ignore type="sregex">.!Check-Point</ignore>
      <ignore type="sregex">.!Endpoint</ignore>
      <ignore type="sregex">.!Sandblast</ignore>
      <ignore type="sregex">.!Sandblast Agent</ignore>
      <ignore type="sregex">.!Sandblast Zero-Day</ignore>
      <ignore type="sregex">.!CP</ignore>
      <ignore type="sregex">.0CheckPoint</ignore>
      <ignore type="sregex">.0Check Point</ignore>
      <ignore type="sregex">.0Check-Point</ignore>
      <ignore type="sregex">.0Endpoint</ignore>
      <ignore type="sregex">.0Sandblast</ignore>
      <ignore type="sregex">.0Sandblast Agent</ignore>
      <ignore type="sregex">.0Sandblast Zero-Day</ignore>
      <ignore type="sregex">.0CP</ignore>
      <ignore type="sregex">CheckPoint</ignore>
      <ignore type="sregex">Check Point</ignore>
      <ignore type="sregex">Check-Point</ignore>
      <ignore type="sregex">Endpoint</ignore>
      <ignore type="sregex">Sandblast</ignore>
      <ignore type="sregex">Sandblast Agent</ignore>
      <ignore type="sregex">Sandblast Zero-Day</ignore>
      <ignore type="sregex">CP</ignore>
      <!-- Ignore IBM storage witness quorum logs -->
      <ignore>/opt/IBM/ip-quorum/log/</ignore>
    </rootcheck>
    <client_buffer>
      <!-- Agent buffer options -->
      <disabled>no</disabled>
      <queue_size>10000</queue_size>
      <events_per_second>1000</events_per_second>
    </client_buffer>
  </agent_config>
  <agent_config os="^Windows">
    <localfile>
      <location>System</location>
      <log_format>eventchannel</log_format>
      <query>
        \<QueryList\>
          \<Query Id='0' Path='System'\>
            \<Select Path='System'\>*\</Select\>
        <!-- Ignore DCOM events.Ref: https://learn.microsoft.com/en-us/troubleshoot/windows-client/application-management/event-10016-logged-when-accessing-dcom -->
            \<Suppress Path='System'\>*[System[(EventID=10016)]] and *[EventData[(Data[@Name='param4'] and Data='{D63B10C5-BB46-4990-A94F-E40B9D520160}' and  Data[@Name='param5'] and Data='{9CA88EE3-ACB7-47C8-AFC4-AB702511C276}' and  Data[@Name='param8'] and Data='S-1-5-18')]]\</Suppress\>
            \<Suppress Path='System'\>*[System[(EventID=10016)]] and *[EventData[( Data[@Name='param4'] and Data='{260EB9DE-5CBE-4BFF-A99A-3710AF55BF1E}' and Data[@Name='param5'] and Data='{260EB9DE-5CBE-4BFF-A99A-3710AF55BF1E}')]]\</Suppress\>
            \<Suppress Path='System'\>*[System[(EventID=10016)]] and *[EventData[(Data[@Name='param4'] and Data='{C2F03A33-21F5-47FA-B4BB-156362A2F239}' and Data[@Name='param5'] and Data='{316CDED5-E4AE-4B15-9113-7055D84DCC97}'  and Data[@Name='param8'] and Data='S-1-5-19')]]\</Suppress\>
            \<Suppress Path='System'\>*[System[(EventID=10016)]] and *[EventData[(Data[@Name='param4'] and Data='{6B3B8D23-FA8D-40B9-8DBD-B950333E2C52}' and Data[@Name='param5'] and Data='{4839DDB7-58C2-48F5-8283-E1D1807D0D7D}' and Data[@Name='param8'] and Data='S-1-5-19')]]\</Suppress\>
        <!-- Suppress noisy event sources that has no security impact -->
            \<Suppress Path='System'\>*[System[Provider[@Name='Microsoft-Windows-Hyper-V-VmSwitch']]]\</Suppress\>
            \<Suppress Path='System'\>*[System[Provider[@Name='Microsoft-Windows-Time-Service']]]\</Suppress\>
            \<Suppress Path='System'\>*[System[Provider[@Name='Microsoft-Windows-DNS-Client']]]\</Suppress\>
            \<Suppress Path='System'\>*[System[Provider[@Name='Netwtw10']]]\</Suppress\> 
        <!-- Intel(R) Wi-Fi driver -->
            \<Suppress Path='System'\>*[System[Provider[@Name='e1dexpress']]]\</Suppress\> 
        <!-- EEE, Energy Efficient Ethernet -->
            \<Suppress Path='System'\>*[System[Provider[@Name='Intel-SST-OED']]]\</Suppress\> 
        <!-- Intel(R) Smart Sound Technology (Intel(R) SST) OED driver -->
            \<Suppress Path='System'\>*[System[Provider[@Name='nhi']]]\</Suppress\> 
        <!-- NHI is Native Host Interface. Driver for thunderbolt. -->
            \<Suppress Path='System'\>*[System[Provider[@Name='Service Control Manager']]] and *[EventData[(Data[@Name='param4'] and Data='BITS')]]\</Suppress\>
            \<Suppress Path='System'\>*[System[(Provider[@Name='Microsoft-Windows-WindowsUpdateClient'] and EventID=44)]]\</Suppress\>
          \</Query\>
        \</QueryList\>
      </query>
    </localfile>
    <localfile>
      <location>Security</location>
      <log_format>eventchannel</log_format>
      <query>
       \<QueryList\>
         \<Query Id='0' Path='Security'\>
           \<Select Path='Security'\>*\</Select\>
        <!-- Wazuh default suppressed events, translated to structured XML filter -->
        <!-- The events below are too noisy but for some detection capabilities, they may need to be enabled. -->
        <!-- 4656(S, F): A handle to an object was requested. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4656)]]\</Suppress\>
        <!-- 4658(S): The handle to an object was closed. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4658)]]\</Suppress\>
        <!-- 4660(S): An object was deleted. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4660)]]\</Suppress\>
        <!-- 4663(S): An attempt was made to access an object. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4663)]]\</Suppress\>
        <!-- 4670(S): Permissions on an object were changed. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4670)]]\</Suppress\>
        <!-- 4690(S): An attempt was made to duplicate a handle to an object. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4690)]]\</Suppress\>
        <!-- 4703(S): A user right was adjusted. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4703)]]\</Suppress\>
        <!-- 4907(S): Auditing settings on object were changed. -->
           \<Suppress Path='Security'\>*[System[(EventID = 4907)]]\</Suppress\>
        <!-- 5145(S, F): A network share object was checked to see whether client can be granted desired access. -->
           \<Suppress Path='Security'\>*[System[(EventID = 5145)]]\</Suppress\>
        <!-- 5152(F): The Windows Filtering Platform blocked a packet. -->
           \<Suppress Path='Security'\>*[System[(EventID = 5152)]]\</Suppress\>
        <!-- 5156(S): The Windows Filtering Platform has permitted a connection. -->
           \<Suppress Path='Security'\>*[System[(EventID = 5156)]]\</Suppress\>
        <!-- 5157(F): The Windows Filtering Platform has blocked a connection. -->
           \<Suppress Path='Security'\>*[System[(EventID = 5157)]]\</Suppress\>
        <!-- 5447(S): A Windows Filtering Platform filter has been changed. -->
           \<Suppress Path='Security'\>*[System[(EventID = 5447)]]\</Suppress\>
        <!-- Not used by any Wazuh rule. We can suppress as 4660 and 4663 consists more information. -->
        <!-- 4659(S): A handle to an object was requested with intent to delete -->
           \<Suppress Path='Security'\>*[System[(EventID = 4659)]]\</Suppress\>
        <!-- Suppress common network noise for EventID 5140 -->
           \<Suppress Path='Security'\>*[System[(EventID=5140)]] and *[EventData[Data[@Name='AccessMask'] and Data='0x1']] and (*[EventData[Data[@Name='ShareName'] and Data='\\*\C$']] and *[EventData[Data[@Name='IpAddress'] and Data='127.0.0.1']])\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=5140)]] and *[EventData[Data[@Name='AccessMask'] and Data='0x1']] and *[EventData[Data[@Name='ShareName'] and Data='\\*\SYSVOL']]\</Suppress\>
        <!-- Suppress log off events for DWM and Font Driver Host -->
           \<Suppress Path='Security'\>*[System[(EventID=4634)]] and *[EventData[(Data[@Name='TargetDomainName'] and Data='Window Manager')]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4634)]] and *[EventData[(Data[@Name='TargetDomainName'] and Data='Font Driver Host')]]\</Suppress\>
        <!-- Suppress valid ANONYMOUS LOGOFF activites related to SMB or RDP -->
        <!-- Ref: https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4634 -->
           \<Suppress Path='Security'\>*[System[(EventID=4634)]] and *[EventData[(Data[@Name='TargetUserName'] and Data='ANONYMOUS LOGON')]]\</Suppress\>
        <!-- Suppress known executables run by SYSTEM -->
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\svchost.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\services.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\SearchIndexer.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\winlogon.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\gpupdate.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\MusNotification.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\sdbinst.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\LogonUI.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\smss.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\powercfg.exe'))]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4688)]] and *[EventData[(Data[@Name='SubjectLogonId'] and (Data='0x3e7' or Data='0x3e4' or Data='0x3e5'))]] and *[EventData[(Data[@Name='ParentProcessName'] and (Data='C:\Windows\System32\CompatTelRunner.exe'))]]\</Suppress\>
        <!-- Suppress noisy 'This event is logged when Windows Firewall did not apply the rule' -->
           \<Suppress Path='Security'\>*[System[(EventID=4957)]]\</Suppress\>
        <!-- Suppress noisy 'The start type of the X service was changed from demand start to auto start' -->
           \<Suppress Path='Security'\>*[System[(EventID=7040)]] and *[EventData[(Data[@Name='param4'] and Data='TrustedInstaller')]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=7040)]] and *[EventData[(Data[@Name='param4'] and Data='BITS')]]\</Suppress\>
        <!-- Suppress noisy scheduled tasks managed by SYSTEM, Local Service and Network Service  -->
           \<Suppress Path='Security'\>*[System[(EventID=4698 or EventID=4699 or EventID=4700 or EventID=4701 or EventID=4702)]] and (*[EventData[(Data[@Name='SubjectUserSid'] and Data='S-1-5-18')]])\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4698 or EventID=4699 or EventID=4700 or EventID=4701 or EventID=4702)]] and (*[EventData[(Data[@Name='SubjectUserSid'] and Data='S-1-5-19')]])\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4698 or EventID=4699 or EventID=4700 or EventID=4701 or EventID=4702)]] and (*[EventData[(Data[@Name='SubjectUserSid'] and Data='S-1-5-20')]])\</Suppress\>
        <!-- Suppress noisy 'A privileged service was called.' -->
           \<Suppress Path='Security'\>*[System[(EventID=4673)]] and (*[EventData[(Data[@Name='ProcessName'] and Data='C:\Program Files\Google\Chrome\Application\chrome.exe')]])\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4673)]] and (*[EventData[(Data[@Name='ProcessName'] and Data='C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe')]])\</Suppress\>
           \<Suppress Path='Security'\>*[System[(EventID=4673)]] and (*[EventData[(Data[@Name='ProcessName'] and Data='C:\Program Files\WindowsApps\Microsoft.DesktopAppInstaller_1.24.25200.0_x64__8wekyb3d8bbwe\WindowsPackageManagerServer.exe')]])\</Suppress\>
        <!-- Removes all service (success/failed) logons from being captured -->
        <!-- LogonType 5 and 0 are respectively used for services and system logons. See: http://blogs.msdn.com/b/ericfitz/archive/2008/02/26/you-learn-something-new-every-day-logon-type-0.aspx -->
           \<Suppress Path='Security'\>*[System[Provider[@Name='Microsoft-Windows-Security-Auditing'] and (Level=4 or Level=0) and (EventID=4624 or EventID=4625 or EventID=4634)]] and *[EventData[(Data[@Name='LogonType'] and Data='5') or (Data[@Name='LogonType'] and Data='0')]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[Provider[@Name='Microsoft-Windows-Security-Auditing'] and (Level=4 or Level=0) and (EventID=4624 or EventID=4625 or EventID=4634)]] and *[EventData[(Data[@Name='TargetUserName'] and Data='ANONYMOUS LOGON')]]\</Suppress\>
           \<Suppress Path='Security'\>*[System[Provider[@Name='Microsoft-Windows-Security-Auditing'] and (Level=4 or Level=0) and (EventID=4624 or EventID=4625 or EventID=4634)]] and *[EventData[(Data[@Name='TargetUserSID'] and Data='S-1-5-18')]]\</Suppress\>
         \</Query\>
       \</QueryList\>
      </query>
    </localfile>
    <!-- Windows Defender is installed on every device version over Windows 10 and Server 2016 -->
    <localfile>
      <location>Microsoft-Windows-Windows Defender/Operational</location>
      <log_format>eventchannel</log_format>
      <query>Event[Sytem/EventID != 1150]</query>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-Sysmon/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
      <query>
      \<QueryList\>
        <!-- Suppress noisy events. It is better to suppress in sysmonconfig. Ref: https://github.com/AustralianCyberSecurityCentre/windows_event_logging -->
      \<Query Id='0' Path='Microsoft-Windows-Sysmon/Operational'\>
      \<Select Path='Microsoft-Windows-Sysmon/Operational'\>*\</Select\>
        <!-- Exclude capturing event forwarding -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[Data[@Name='Image'] and Data='C:\Windows\System32\svchost.exe' and Data[@Name='DestinationPort'] and Data='5985']]\</Suppress\>            
        <!-- Exclude common local networking activity generated by system accounts -->
        <!-- Exclude DNS activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 53]]\</Suppress\>
        <!-- Exclude BOOTP activity generated by system accounts (Port 67) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 67]]\</Suppress\>
        <!-- Exclude BOOTP activity generated by system accounts (Port 68) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 68]]\</Suppress\>
        <!-- Exclude Kerberos activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 88]]\</Suppress\>
        <!-- Exclude NTP activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 123]]\</Suppress\>
        <!-- Exclude DCOM activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 135]]\</Suppress\>
        <!-- Exclude SMB/NetBIOS activity generated by system accounts (Port 137) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 137]]\</Suppress\>
        <!-- Exclude SMB/NetBIOS activity generated by system accounts (Port 138) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 138]]\</Suppress\>
        <!-- Exclude SMB/NetBIOS activity generated by system accounts (Port 139) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 139]]\</Suppress\>
        <!-- Exclude LDAP activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 389]]\</Suppress\>
        <!-- Exclude SMB activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 445]]\</Suppress\>
        <!-- Exclude DHCPv6 activity generated by system accounts (Port 546) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 546]]\</Suppress\>
        <!-- Exclude DHCPv6 activity generated by system accounts (Port 547) -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 547]]\</Suppress\>
        <!-- Exclude LLMNR activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 5355]]\</Suppress\>
        <!-- Exclude UPnP activity generated by system accounts -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[EventData[(Data[@Name='User'] = 'NT AUTHORITY\SYSTEM' or Data[@Name='User'] = 'NT AUTHORITY\LOCAL SERVICE' or Data[@Name='User'] = 'NT AUTHORITY\NETWORK SERVICE') and Data[@Name='DestinationPort'] = 1900]]\</Suppress\>   
        <!-- Exclude process access unless targeting LSASS or WinLogon -->
      \<Suppress Path='Microsoft-Windows-Sysmon/Operational'\>*[System[(EventID=10)]] and (*[EventData[Data[@Name='GrantedAccess'] and Data='0x1410']] and (*[EventData[Data[@Name='TargetImage'] and Data='C:\Windows\system32\lsass.exe']] or*[EventData[Data[@Name='TargetImage'] and Data='C:\Windows\system32\winlogon.exe']]))\</Suppress\>
      \</Query\>
      \</QueryList\>
      </query>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-Windows Firewall With Advanced Security/Firewall</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <!-- Powershell script logging -->
    <localfile>
      <location>Microsoft-Windows-PowerShell/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <!-- Powershell script logging for new PowerShell -->
    <localfile>
      <location>PowerShellCore/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-TerminalServices-RemoteConnectionManager/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-TerminalServices-LocalSessionManager/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-Application-Experience/Program-Inventory</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <!-- 3008: DNS Client events Query Completed
    Suppresses local machine name resolution events
    Suppresses empty name resolution events
    Ref: https://github.com/palantir/windows-event-forwarding/blob/master/wef-subscriptions/DNS.xml -->
    <localfile>
      <location>Microsoft-Windows-DNS-Client/Operational</location>
      <log_format>eventchannel</log_format>
      <query>Event[System/EventID=3008 and (EventData/Data[@Name="QueryOptions"] != "140737488355328" and EventData/Data[@Name="QueryResults"]!="")]</query>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-DriverFrameworks-UserMode/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-TaskScheduler/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-VHDMP/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-SMBServer/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-SMBServer/Connectivity</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-SMBClient/Operational</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-SmbClient/Connectivity</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
    </localfile>
    <!-- Windows Applocker events -->
    <localfile>
      <location>Microsoft-Windows-AppLocker/EXE and DLL</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
      <query>Event/System[EventID = 8003 or EventID = 8004]</query>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-AppLocker/MSI and Script</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
      <query>Event/System[EventID = 8006 or EventID = 8007]</query>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-AppLocker/Packaged app-Deployment</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
      <query>Event/System[EventID = 8024 or EventID = 8025]</query>
    </localfile>
    <localfile>
      <location>Microsoft-Windows-AppLocker/Packaged app-Execution</location>
      <log_format>eventchannel</log_format>
      <only-future-events>no</only-future-events>
      <query>Event/System[EventID = 8021 or EventID = 8022]</query>
    </localfile>
    <!-- Windows Defender Firewall logs are plain text logs. -->
    <!-- Wazuh agent on Windows is a 32-bit application so it needs to define Sysnative to access System32 folder -->
    <!-- Ref: https://learn.microsoft.com/en-us/windows/win32/winprog64/file-system-redirector -->
    <localfile>
      <location>%WINDIR%\Sysnative\logfiles\firewall\*.log</location>
      <only-future-events>no</only-future-events>
      <ignore>ALLOW</ignore>
      <log_format>syslog</log_format>
    </localfile>
    <!-- Collect agent ERROR logs -->
    <localfile>
      <location>%PROGRAMFILES(X86)%\ossec-agent\ossec.log</location>
      <only-future-events>no</only-future-events>
      <restrict>ERROR</restrict>
      <log_format>syslog</log_format>
    </localfile>
    <!-- File integrity monitoring -->
    <syscheck>
      <disabled>no</disabled>
      <!-- Frequency that syscheck is executed default every 6 hours -->
      <frequency>21600</frequency>
      <scan_on_start>yes</scan_on_start>
      <!-- The allowed values for the realtime attribute are yes and no, and it only works with directories, not individual files. -->
      <!-- Directories to check in Windows (perform all possible verifications) -->
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="regedit.exe$|system.ini$|win.ini$">%WINDIR%</directories>
      <directories whodata="yes" recursion_level="0" restrict="at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedt32.exe|regsvr32.exe|runas.exe|sc.exe|schtasks.exe|sethc.exe|subst.exe$">%WINDIR%\SysNative</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0">%WINDIR%\SysNative\drivers\etc</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="WMIC.exe$">%WINDIR%\SysNative\wbem</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="powershell.exe$">%WINDIR%\SysNative\WindowsPowerShell\v1.0</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="winrm.vbs$">%WINDIR%\SysNative</directories>
      <!-- 32-bit programs. -->
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="at.exe$|attrib.exe$|cacls.exe$|cmd.exe$|eventcreate.exe$|ftp.exe$|lsass.exe$|net.exe$|net1.exe$|netsh.exe$|reg.exe$|regedit.exe$|regedt32.exe$|regsvr32.exe$|runas.exe$|sc.exe$|schtasks.exe$|sethc.exe$|subst.exe$">%WINDIR%\System32</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0">%WINDIR%\System32\drivers\etc</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="WMIC.exe$">%WINDIR%\System32\wbem</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="winrm.vbs$">%WINDIR%\System32</directories>
      <directories check_all="yes" realtime="yes">%PROGRAMDATA%\Microsoft\Windows\Start Menu\Programs\Startup</directories>
      <!-- Drives other than C. Wildcard does not help and regex is not allowed. -->
      <directories check_all="yes" whodata="yes">D:,E:,F:,G:,H:,I:,J:,K:,L:,M:,N:,O:,P:,Q:,R:,S:,T:,U:,V:,W:,X:,Y:,Z:</directories>
      <!-- Check Point Harmony EDR creates high number of files for backup up internal data. It uses hundreds of volumes for zip files. We can ignore them. -->
      <ignore>E:\harmonybackup</ignore>
      <!-- Ignore Check Point Identity Collector statistics -->
      <ignore>%SYSTEMDRIVE%\programdata\checkpoint\identitycollector</ignore>
      <!-- Ignore Check Point EDR database -->
      <ignore>%SYSTEMDRIVE%\programdata\checkpoint\dbstore</ignore>
      <!-- Ignore Wazuh agent statistics change -->
      <ignore>%SYSTEMDRIVE%\program files (x86)\ossec-agent\wazuh-agent.state</ignore>
      <ignore>%SYSTEMDRIVE%\program files (x86)\ossec-agent\wazuh-logcollector.state</ignore>
      <ignore>%SYSTEMDRIVE%\program files (x86)\ossec-agent\queue\logcollector\file_status.json</ignore>
      <ignore>%SYSTEMDRIVE%\program files (x86)\ossec-agent\queue\syscollector\db\local.db-journal</ignore>
      <ignore>%SYSTEMDRIVE%\program files (x86)\ossec-agent\queue\fim\db\fim.db-journal</ignore>
      <ignore>%SYSTEMDRIVE%\program files (x86)\ossec-agent\rids\sender_counter</ignore>
      <!-- Ignore SQLite DB and WAL (write-ahead log) files -->
      <ignore>.wal$|.db-wal$|.db$</ignore>
      <!-- log files on clearing -->
      <ignore>%SYSTEMDRIVE%\program files (x86)\systemscheduler\events</ignore>
      <ignore>%SYSTEMDRIVE%\mk_agent\alertfiles</ignore>
      <!-- Recommended items to monitor
      Ref: https://learn.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-enable-log-analytics#recommended-items-to-monitor) -->
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="autoexec.bat$|boot.ini$|config.sys">%SYSTEMDRIVE%</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="userinit.exe$">%WINDIR%\System32</directories>
      <!-- Monitor Downloads folder. Needed to compare hashes against known IOCs -->
      <directories check_all="yes" whodata="yes">%SYSTEMDRIVE%\Users\*\Downloads</directories>
      <!-- PowerShell 7 -->
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="pwsh.exe$">%SYSTEMDRIVE%\Program Files\PowerShell\7</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" report_changes="yes">%SYSTEMDRIVE%\Program Files\PowerShell\7</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" report_changes="yes">%SYSTEMDRIVE%\Users\*\Documents\PowerShell</directories>
      <!-- PowerShell 5.1 -->
      <directories check_all="yes" whodata="yes" recursion_level="0" restrict="powershell.exe$">%WINDIR%\System32\WindowsPowerShell\v1.0</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0">%WINDIR%\System32\WindowsPowerShell\v1.0</directories>
      <directories check_all="yes" whodata="yes" recursion_level="0" report_changes="yes">%SYSTEMDRIVE%\Users\*\Documents\WindowsPowerShell</directories>
      <!-- Sysmon rules as binary blob in registry -->
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\SysmonDrv\Parameters\Rules</windows_registry>
      <!-- Windows registry entries to monitor. -->
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Microsoft Defender</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\Session Manager</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunServices</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunOnce</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServicesOnce</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\RunServices</windows_registry>
      <!-- Custom Windows registry entries to monitor. -->
      <!-- TLS settings (Reference: https://www.nartac.com/Products/IISCrypto/FAQ/what-registry-keys-does-iis-crypto-modify)-->
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\FipsAlgorithmPolicy</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SHKLM\SOFTWARE\Policies\Microsoft\Cryptography\Configuration\SSL\00010002</windows_registry>
      <!-- Security critical file paths -->
      <directories check_all="yes" whodata="yes" recursion_level="0">%WINDIR%\SysNative\GroupPolicy</directories>
      <!-- Security critical registry keys to monitor -->
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Classes\Mscfile\Shell\Open\Command</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\App Paths\Control.exe</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Classes\Exefile\Shell\Runas\Command\IsolatedCommand</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows Nt\CurrentVersion\Imagefileexecutionoptions</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USBTor</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Enum\USB</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Environment</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Control Panel\Desktop\Scrnsave.exe</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Command Processor\Autorun</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Desktop\Components</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Explorer Bars</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\Extensions</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Internet Explorer\UrlSearchHooks\Server\Install\Software\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Windows\Run</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Winlogon</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows NT\CurrentVersion\Run</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\Control Panel\Desktop\Scrnsave.exe</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Policies\Microsoft\Windows\System\Scripts\Logoff</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Wow6432Node\Microsoft\Internet Explorer\Explorer Bars</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Wow6432Node\Microsoft\Internet Explorer\Extensions</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Winlogon</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\System</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Taskman</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\GroupPolicy\Scripts\Shutdown</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\GroupPolicy\Scripts\Startup</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\System\Shell</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System\Scripts\Logoff</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System\Scripts\Logon</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System\Scripts\Shutdown</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Policies\Microsoft\Windows\System\Scripts\Startup</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Command\Processor\Autorun</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Internet Explorer\Explorer Bars</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Internet Explorer\Extensions</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Internet Explorer\Toolbar</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Run</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\RunOnce</windows_registry>
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\System\CurrentControlSet\Control\LSA</windows_registry>
      <!-- Keyboard locale setting, needed to detect changes when RDP connections are made -->
      <windows_registry arch="both">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Keyboard Layout</windows_registry>
      <windows_registry arch="both">HKEY_CURRENT_USER\Keyboard Layout\Preload</windows_registry>
      <!-- Database synchronization settings -->
      <synchronization>
        <max_eps>20</max_eps>
      </synchronization>
      <!-- Maximum number of files to be monitored -->
      <file_limit>
        <enabled>yes</enabled>
        <entries>200000</entries>
      </file_limit>
      <!-- Maximum number of registries to be monitored -->
      <registry_limit>
        <enabled>yes</enabled>
        <entries>500000</entries>
        <diff_size_limit>100MB</diff_size_limit>
      </registry_limit>
    </syscheck>
    <client_buffer>
      <!-- Agent buffer options -->
      <disabled>no</disabled>
      <queue_size>50000</queue_size>
      <events_per_second>1000</events_per_second>
    </client_buffer>
  </agent_config>
